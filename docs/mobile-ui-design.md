# ListenTogether 手机端UI设计方案

## 一、设计原则

- 功能与PC端完全一致，不砍任何功能
- 仅通过CSS媒体查询 + index.html结构微调实现，不改JS逻辑文件
- 参考Spotify/网易云的全屏播放页 + mini bar双层结构
- 触屏友好：所有可点击元素≥44px，无hover依赖
- 单手操作：核心控制集中在屏幕下半部分
- 性能优先：手机端减少backdrop-filter层数，简化动画

## 二、断点定义

| 断点 | 范围 | 目标设备 |
|------|------|----------|
| mobile | ≤639px | 手机竖屏 |
| tablet | 640px-1023px | 平板/手机横屏 |
| desktop | ≥1024px | PC（现有布局） |

主要工作集中在 ≤639px 断点。

## 三、整体架构（手机端）

手机端房间页分为三层：

```
┌─────────────────────────┐
│     全屏播放页            │  ← 默认展开状态
│  (封面/歌词/控制/进度)     │
├─────────────────────────┤
│     Mini Bar             │  ← 全屏收起时显示
├─────────────────────────┤
│     底部面板(抽屉式)       │  ← 播放列表/用户列表/设置
└─────────────────────────┘
```

### 状态切换
- **全屏播放页**（默认）：沉浸式播放界面
- **Mini Bar + 内容页**：下拉收起播放页后，显示播放列表/房间信息
- 通过点击Mini Bar或上滑手势展开全屏播放页

## 四、登录页 & 首页（手机端）

现有布局已经是 `max-w-md` 居中，手机端基本OK，微调：

- 登录页：padding改为 `px-6`，按钮高度≥48px
- 首页（创建/加入房间）：同上，输入框和按钮加大触摸区域
- 无需大改

## 五、全屏播放页（核心）

### 布局（从上到下，总高度=100vh）

```
┌─────────────────────────────┐
│ 顶栏 (48px)                  │  房间码 + 在线人数 + ⋯菜单
│                              │
│                              │
│ 封面区 (约50vh)               │  专辑封面（vinyl旋转/card静态）
│                              │  居中，宽度=屏幕宽-48px，1:1比例
│                              │
│                              │
├─────────────────────────────┤
│ 歌曲信息 (48px)               │  歌名(18px粗体) + 歌手(14px灰色)
├─────────────────────────────┤
│ 歌词区 (约80px)               │  当前歌词1-2行，点击可展开歌词面板
├─────────────────────────────┤
│ 进度条 (40px)                 │  细进度条 + 时间显示，可拖拽
├─────────────────────────────┤
│ 控制区 (64px)                 │  ◁ ▶/⏸ ▷  (大按钮56px)
├─────────────────────────────┤
│ 工具栏 (48px)                 │  音质 | 列表 | 用户 | 设置
├─────────────────────────────┤
│ safe-area padding            │
└─────────────────────────────┘
```

### 顶栏 (48px)
- 左：下拉箭头 `∨`（点击收起为mini bar）
- 中：房间码 + 同步状态指示灯（绿点=已同步）
- 右：在线人数图标 + `⋯` 更多菜单（布局编辑器入口等）

### 封面区
- **vinyl模式**：黑胶唱片居中旋转，直径=min(屏幕宽-48px, 50vh)
- **card模式**：专辑封面圆角方形，同尺寸
- 封面下方可选显示磨玻璃背景（手机端降低blur强度为5px节省GPU）

### 歌曲信息
- 歌名：`font-size: 18px; font-weight: 600;` 单行溢出省略
- 歌手：`font-size: 14px; color: gray;` 单行溢出省略
- 左对齐，padding: 0 24px

### 歌词区（精简显示）
- 默认只显示当前歌词1-2行，居中，`font-size: 15px`
- 点击歌词区 → 展开全屏歌词面板（覆盖封面区，半透明背景）
- 全屏歌词面板：滚动歌词列表，当前行高亮，点击空白区收起

### 进度条
- 高度40px（含触摸区域），实际进度条高度4px
- 拖拽时进度条变粗为6px（反馈感）
- 左右显示 当前时间 / 总时长，`font-size: 11px`

### 控制区
- 三个主按钮水平居中，间距48px
- 上一首/下一首：36px图标
- 播放/暂停：56px圆形按钮，带背景色（emerald-500）
- 两侧可选：随机/循环模式（如果有的话）

### 工具栏
- 四个图标按钮均分宽度，每个≥44px触摸区域
- 音质选择 | 播放列表 | 用户列表 | 设置
- 点击后以底部抽屉(bottom sheet)形式弹出对应面板

## 六、Mini Bar（收起状态）

当用户从全屏播放页下拉收起时显示：

```
┌──────────────────────────────────┐
│ [封面48x48] 歌名-歌手    ▶/⏸  ▷ │  高度: 64px
│ [进度条 - 底部2px细线]            │
└──────────────────────────────────┘
```

- 固定在屏幕底部
- 左：小封面48x48圆角
- 中：歌名+歌手（单行，溢出省略）
- 右：播放/暂停 + 下一首按钮
- 底部：2px进度条（纯视觉，不可拖拽）
- 点击Mini Bar（非按钮区域）→ 展开全屏播放页

## 七、底部抽屉面板（Bottom Sheet）

工具栏的四个功能通过底部抽屉弹出：

### 通用样式
- 从底部滑入，圆角顶部16px
- 最大高度70vh，可滚动
- 背景白色，顶部有拖拽条（40px宽，4px高，灰色圆角）
- 点击遮罩层或下拉关闭

### 播放列表面板
- 列表项：封面缩略图40x40 + 歌名/歌手 + 时长
- host可见：删除按钮、拖拽排序手柄
- 底部：添加歌曲按钮（host可见）
- 当前播放项高亮（emerald色左边框）

### 用户列表面板
- 用户头像(32px圆形) + 用户名 + host标识(皇冠图标)
- 显示每个用户的同步状态

### 设置面板
- 音质选择（radio按钮组）
- 样式切换（vinyl/card）
- 音量滑块
- 其他设置项

### 音质选择
- 可以合并到设置面板，或独立为一个小面板
- 三档：低/中/高，radio样式

## 八、歌词全屏面板

- 覆盖封面区域（不覆盖控制区）
- 半透明深色背景 `rgba(0,0,0,0.85)`
- 歌词列表垂直居中滚动
- 当前行：白色大字(18px)，其他行：灰色小字(14px, opacity:0.5)
- 自动滚动跟随当前歌词
- 点击任意空白区域关闭

## 九、Vinyl/Card样式适配

### Vinyl模式（手机端）
- 黑胶唱片居中，直径适配屏幕宽度
- 播放时旋转动画保留（降低为 `animation: spin 20s linear infinite`）
- 唱针动画可简化或去掉（节省性能）

### Card模式（手机端）
- 方形封面居中，圆角12px
- 可加轻微阴影
- 无旋转动画

## 十、与PC端的兼容策略

### 不改动的部分
- 所有JS逻辑文件（player.js/sync.js/app.js/auth.js）
- WebSocket通信
- 音频播放引擎
- 同步算法

### CSS媒体查询策略
```css
/* 手机端样式 */
@media (max-width: 639px) {
    /* 隐藏PC端布局元素 */
    /* 显示手机端专用元素 */
    /* 重排现有元素为垂直堆叠 */
}
```

### index.html结构调整
需要的最小改动：
1. 添加 Mini Bar 的HTML结构（PC端通过CSS隐藏）
2. 添加底部抽屉容器（PC端隐藏）
3. 给现有元素添加手机端辅助class
4. 顶栏增加下拉收起按钮（PC端隐藏）

### 布局编辑器
- 手机端隐藏布局编辑器入口（拖拽定位在触屏上体验差）
- 或简化为预设布局选择（3-4个预设，点击切换）

## 十一、动画与过渡

| 动画 | 手机端处理 |
|------|-----------|
| 全屏展开/收起 | transform: translateY(0/100%) + transition 300ms ease |
| 底部抽屉 | transform: translateY(0/100%) + transition 250ms ease |
| 歌词面板 | opacity 0→1 + transition 200ms |
| vinyl旋转 | 保留，降速到20s/圈 |
| 磨玻璃背景 | blur降为5px，或手机端关闭 |
| 封面脉冲动画 | 手机端关闭（节省GPU） |

## 十二、Safe Area处理

```css
@media (max-width: 639px) {
    .player-fullscreen {
        padding-bottom: env(safe-area-inset-bottom, 0);
    }
    .mini-bar {
        padding-bottom: env(safe-area-inset-bottom, 0);
    }
}
```

## 十三、实施优先级

1. **P0**：全屏播放页基本布局（封面+信息+进度+控制）
2. **P0**：Mini Bar
3. **P1**：底部抽屉（播放列表/用户列表/设置）
4. **P1**：歌词面板
5. **P2**：动画过渡优化
6. **P2**：vinyl/card双样式适配
7. **P3**：布局编辑器手机端适配
